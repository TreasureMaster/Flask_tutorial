{% extends 'base.html' %}

{% block header %}
    <h1>{% block title %}{{ post['title'] }}{% endblock %}</h1>
{% endblock %}

{% block content %}
<article class="post">
    <header>
        <div class="about">by {{ post['username'] }} on {{ post['created'].strftime('%Y-%m-%d') }}</div>
        {% if g.user['id'] == post['author_id'] %}
        <a href="{{ url_for('blog.delete', id=post['id']) }}" class="action">Delete</a>
        <a href="{{ url_for('blog.update', id=post['id']) }}" class="action">Edit</a>
        {% endif %}
    </header>
    <p class="body">{{ post['body'] }}</p>
</article>
<hr>
<div class="likes">
    <p>Likes: {{ post['like'] }} Dislikes: {{ post['dislike'] }}</p>
    {% if g.user['id'] and not post['is_author'] %}
    <p>
    <a href="{{ url_for('post.like', id=post['id'], regard='like') }}" class="action">Like it</a>
    <a href="{{ url_for('post.like', id=post['id'], regard='dislike') }}" class="action">Dislike it</a>
    </p>
    {% endif %}
</div>
<hr>
    <div class="content comments">
        <header>
            <h2>Comments:</h2>
            {#{% if g.user %}
            <a href="{{ url_for('blog.create') }}" class="action">New Comment</a>
            {% endif %}#}
        </header>
        {% if g.user %}
        <div class="comment">
            <form method="post" action="{{ url_for('post.comment', id=post['id']) }}">
                <p class="textcomment"><textarea name="comment" id="comment">{{ request.form['comment'] }}</textarea></p>
                <p><input type="submit" value="Add Comment"></p>
            </form>
        <hr>
        </div>
        {% endif %}
        {% for comment in comments %}
            <article class="post">
                <header>
                    <div>
                        {#<h1><a href="{{ url_for('post.view', id=post['id']) }}">{{ post['title'] }}</a></h1>#}
                        <div class="about">by {{ comment['username'] }} on {{ comment['created'].strftime('%Y-%m-%d') }}</div>
                    </div>
                    {% if g.user['id'] == comment['user_id'] %}
                    <a href="{{ url_for('post.update', id=comment['id'], post=comment['post']) }}" class="action">Edit</a>
                    {% endif %}
                </header>
                <p class="body">{{ comment['comment'] }}</p>
            </article>
            {% if not loop.last %}
                <hr>
            {% endif %}
        {% endfor %}
    </div>
{% endblock %}